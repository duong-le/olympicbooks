<app-cart-empty *ngIf="!cart?.totalQty"></app-cart-empty>

<div class="container" *ngIf="cart?.totalQty">
  <div nz-row [nzGutter]="[16, 16]">
    <div nz-col nzXl="16" nzMd="12" nzXs="24">
      <div nz-row [nzGutter]="[0, 16]">
        <div nz-col nzSpan="24" *ngFor="let item of cart?.cartItems">
          <nz-card [nzLoading]="isLoading">
            <div nz-row nzJustify="space-between" nzAlign="middle" [nzGutter]="[0, 16]">
              <div nz-col nzXl="4" nzXs="8">
                <a [routerLink]="['/products', item?.product.id]">
                  <img [src]="item?.product?.images[0]?.imgUrl" (load)="onLoadImage($event)" height="80" width="80"></a>
              </div>
              <div nz-col nzXl="9" nzXs="16">
                <a [routerLink]="['/products', item?.product.id]">
                  <h3 class="name">{{ item?.product.title }}</h3>
                </a>
              </div>
              <div nz-col nzXl="3">
                <nz-input-number [(ngModel)]="item.quantity" [nzMin]="minQty" [nzMax]="maxQty" [nzStep]="1"
                  (ngModelChange)="changeQuantity(item?.id, item?.quantity)" [nzDisabled]="isDisabled">
                </nz-input-number>
              </div>
              <div nz-col nzXl="3">
                <span class="price">{{ item?.quantity * item?.product.price | price }}</span>
              </div>
              <div nz-col>
                <button nz-button (click)="deleteCartItem(item.id)" [disabled]="isDisabled">
                  <i nz-icon nzType="delete"></i></button>
              </div>
            </div>
          </nz-card>
        </div>
      </div>
    </div>

    <div nz-col nzXl="8" nzMd="12" nzXs="24">
      <div nz-row [nzGutter]="[0,16]">
        <div nz-col nzSpan="24">
          <nz-card [nzLoading]="isLoading" nzTitle="Mã giảm giá" [nzBordered]="false">
            <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton">
              <input type="text" nz-input placeholder="Nhập mã giảm giá" />
            </nz-input-group>
            <ng-template #suffixIconButton>
              <button nz-button nzType="primary" nzSearch [disabled]="isDisabled"><i nz-icon nzType="gift"></i></button>
            </ng-template>
          </nz-card>
        </div>

        <div nz-col nzSpan="24">
          <nz-card [nzLoading]="isLoading" nzTitle="Đơn hàng" [nzBordered]="false">
            <div nz-row nzJustify="space-between" class="summary-row">
              <div nz-col> <span>Tạm tính</span> </div>
              <div nz-col>
                <span class="summary-price price">{{ cart?.totalValue | price }}</span>
              </div>
            </div>

            <div nz-row nzJustify="space-between" class="summary-row">
              <div nz-col> <span>Giảm giá</span> </div>
              <div nz-col>
                <span class="summary-price price">{{ cart?.discountValue | price }}</span>
              </div>
            </div>

            <nz-divider></nz-divider>

            <div nz-row nzJustify="space-between" class="summary-row">
              <div nz-col> <span>Tổng cộng</span> </div>
              <div nz-col>
                <span class="summary-price price">{{ cart?.totalValue - cart?.discountValue | price }}</span>
              </div>
            </div>
            <button nz-button nzType="primary" routerLink="/checkout" nzBlock [disabled]="isDisabled">Xác nhận</button>
          </nz-card>
        </div>
      </div>
    </div>
  </div>
</div>