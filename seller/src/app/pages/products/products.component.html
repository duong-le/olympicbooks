<div nz-row nzJustify="end" [nzGutter]="[16, 16]" class="p-b-16">
  <div nz-col>
    <button nz-button nzType="primary" routerLink="new">
      <i nz-icon nzType="plus-circle" theme="outline"></i>
      <span>Thêm mới</span>
    </button>
  </div>
</div>

<nz-table
  #table
  nzOuterBordered
  nzShowSizeChanger
  [nzFrontPagination]="false"
  [nzLoading]="isLoading"
  [nzLoadingIndicator]="loadingIndicator"
  [nzScroll]="{ x: '1150px' }"
  [nzData]="products"
  [nzTotal]="total"
  [nzPageSize]="pageSize"
  [nzPageIndex]="pageIndex"
  [nzPageSize]="pageSize"
  (nzQueryParams)="changeQueryParams($event)"
>
  <thead>
    <tr>
      <th
        *ngFor="let column of columns"
        [nzSortFn]="column.sort"
        [nzColumnKey]="column.key"
        [nzWidth]="column.width"
      >
        {{ column.title }}
      </th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let item of table.data">
      <td>
        <nz-space>
          <button
            *nzSpaceItem
            nz-button
            nzType="text"
            nz-tooltip
            nzTooltipTitle="Chi tiết sản phẩm"
            (click)="showDetailModal(productModal, item)"
          >
            <i nz-icon nzType="eye" theme="twotone"></i>
          </button>
          <button
            *nzSpaceItem
            nz-button
            nzType="text"
            nz-tooltip
            nzTooltipTitle="Chỉnh sửa sản phẩm"
            [routerLink]="[item?.id]"
          >
            <i nz-icon nzType="edit" theme="twotone"></i>
          </button>
          <button
            *nzSpaceItem
            nz-button
            nzType="text"
            nz-tooltip
            nzTooltipTitle="Xoá sản phẩm"
            nzDanger
            (click)="showDeleteConfirmModal(item?.id)"
          >
            <i nz-icon nzType="delete" theme="outline"></i>
          </button>
        </nz-space>
      </td>
      <td>{{ item?.id }}</td>
      <td>{{ item?.title }}</td>
      <td>{{ item?.category?.title }}</td>
      <td>{{ item?.publisher?.name }}</td>
      <td>{{ item?.authors?.length }}</td>
      <td>
        <nz-tag [nzColor]="item?.status | productstatus: true">
          {{ item?.status | productstatus }}
        </nz-tag>
      </td>
      <td>{{ item?.price | price }}</td>
      <td>{{ item?.originalPrice | price }}</td>
    </tr>
  </tbody>
</nz-table>

<ng-template #loadingIndicator><i nz-icon nzType="loading" class="loading"></i></ng-template>

<ng-template #productModal let-product>
  <nz-descriptions nzBordered [nzColumn]="1">
    <nz-descriptions-item nzTitle="Tên Sách">{{ product?.title }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Số trang">{{ product?.pages }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Cân nặng (grams)">{{ product?.weight }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Năm xuất bản">{{ product?.publicationYear }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Giá bán">{{ product?.price | price }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Giá gốc">{{ product?.originalPrice | price }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Trạng thái">
      <nz-tag [nzColor]="product?.status | productstatus: true">
        {{ product?.status | productstatus }}
      </nz-tag>
    </nz-descriptions-item>
    <nz-descriptions-item nzTitle="Danh mục">{{ product?.category?.title }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Nhà xuất bản">{{ product?.publisher?.name }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Tác giả">
      <ng-container *ngFor="let author of product?.authors">{{ author.name }} <br /></ng-container>
    </nz-descriptions-item>
  </nz-descriptions>

  <nz-card nzType="inner" nzTitle="Mô tả sản phẩm">
    <div class="product-description">{{ product?.description }}</div>
  </nz-card>

  <nz-card nzType="inner" nzTitle="Hình ảnh">
    <nz-image-group>
      <ng-container *ngFor="let image of product.images">
        <div class="product-image-container">
          <img nz-image class="product-image" [nzSrc]="image?.imgUrl" [alt]="image?.imgName" />
        </div>
      </ng-container>
    </nz-image-group>
  </nz-card>
</ng-template>
