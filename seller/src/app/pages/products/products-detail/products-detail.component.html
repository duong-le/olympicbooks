<nz-affix class="affix" [nzOffsetTop]="96">
  <nz-anchor [nzAffix]="false" nzShowInkInFixed>
    <nz-link nzTitle="TT cơ bản" nzHref="#basic-info"></nz-link>
    <nz-link nzTitle="TT bán hàng" nzHref="#sale-info"></nz-link>
    <nz-link nzTitle="Hình ảnh" nzHref="#images"></nz-link>
  </nz-anchor>
</nz-affix>

<div class="container">
  <nz-page-header [nzGhost]="false" nzBackIcon (nzBack)="goBack()">
    <nz-page-header-title *ngIf="isNew">Thêm mới sản phẩm</nz-page-header-title>
    <nz-page-header-title *ngIf="!isNew">Sản phẩm #{{ product?.id }}</nz-page-header-title>
    <nz-page-header-extra>
      <button
        nz-button
        nzType="primary"
        [nzLoading]="isBtnLoading"
        (click)="isNew ? create() : update()"
        [disabled]="productForm.invalid || productForm.pristine"
      >
        Lưu
      </button>
    </nz-page-header-extra>
  </nz-page-header>

  <form nz-form [formGroup]="productForm">
    <nz-card [nzLoading]="isLoading" nzTitle="Thông tin cơ bản" id="basic-info">
      <nz-form-item *ngIf="!isNew">
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="id" nzRequired>ID</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24">
          <input nz-input formControlName="id" type="text" />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="title" nzRequired>Tên sản phẩm</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <input nz-input formControlName="title" type="text" />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="description" nzRequired>
          Mô tả sản phẩm
        </nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <textarea nz-input [nzAutosize]="{ minRows: 3 }" formControlName="description"></textarea>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="pages" nzRequired>Số trang</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <input nz-input formControlName="pages" type="number" />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="weight" nzRequired>
          Cân nặng (grams)
        </nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <input nz-input formControlName="weight" type="number" />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="publicationYear" nzRequired>
          Năm xuất bản
        </nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <input nz-input formControlName="publicationYear" type="number" />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="categoryId" nzRequired>
          Danh mục
        </nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24">
          <nz-tree-select
            [nzNodes]="categoryTree"
            nzShowSearch
            [nzHideUnMatched]="true"
            [nzDefaultExpandAll]="true"
            [nzDropdownStyle]="{ 'max-height': '500px' }"
            formControlName="categoryId"
          >
          </nz-tree-select>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="publisherId" nzRequired>
          Nhà xuất bản
        </nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <nz-select nzShowSearch nzAllowClear formControlName="publisherId">
            <nz-option
              *ngFor="let publisher of publishers"
              [nzLabel]="publisher?.name"
              [nzValue]="publisher?.id"
            >
            </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="authorId" nzRequired>Tác giả</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <nz-select nzShowSearch nzAllowClear nzMode="multiple" formControlName="authorIds">
            <nz-option *ngFor="let author of authors" [nzLabel]="author?.name" [nzValue]="author?.id">
            </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </nz-card>

    <nz-card [nzLoading]="isLoading" nzTitle="Thông tin bán hàng" id="sale-info">
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="price" nzRequired>Giá bán</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <input nz-input formControlName="price" type="number" />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="originalPrice" nzRequired>
          Giá gốc
        </nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <input nz-input formControlName="originalPrice" type="number" />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzMd]="6" [nzSm]="8" [nzXs]="24" nzFor="status" nzRequired>Trạng thái</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input this field!">
          <nz-select nzShowSearch nzAllowClear formControlName="status">
            <nz-option
              *ngFor="let status of productStatus | keyvalue"
              [nzLabel]="status.value | productstatus"
              [nzValue]="status.value"
            >
            </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </nz-card>
  </form>

  <nz-card [nzLoading]="isLoading" nzTitle="Hình ảnh" id="images">
    <nz-upload
      [(nzFileList)]="fileList"
      nzListType="picture"
      [nzAccept]="fileTypeLimit"
      [nzFileType]="fileTypeLimit"
      [nzSize]="fileSizeLimit"
      [nzMultiple]="true"
      [nzBeforeUpload]="beforeUpload"
      (nzChange)="handleUploadEventChange($event)"
    >
      <button nz-button><i nz-icon nzType="upload"></i>Tải ảnh lên</button>
    </nz-upload>
  </nz-card>
</div>
